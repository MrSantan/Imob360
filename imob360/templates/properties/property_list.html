
{% extends 'base.html' %}
{% load static %}

{% block title %}Todas as Propriedades - Imob360{% endblock %}

{% block content %}
<section class="section">
    <div class="container">
        <h1 class="section-title">Todas as Propriedades</h1>
        
        <!-- Filtros -->
        <div class="search-bar">
            <form method="GET" class="search-form">
                <input type="text" name="city" placeholder="Cidade..." value="{{ request.GET.city }}">
                <select name="transaction_type">
                    <option value="">Comprar ou Alugar</option>
                    {% for value, label in transaction_types %}
                        <option value="{{ value }}" {% if request.GET.transaction_type == value %}selected{% endif %}>{{ label }}</option>
                    {% endfor %}
                </select>
                <select name="property_type">
                    <option value="">Tipo de Imóvel</option>
                    {% for value, label in property_types %}
                        <option value="{{ value }}" {% if request.GET.property_type == value %}selected{% endif %}>{{ label }}</option>
                    {% endfor %}
                </select>
                <input type="number" name="min_price" placeholder="Preço mín." value="{{ request.GET.min_price }}">
                <input type="number" name="max_price" placeholder="Preço máx." value="{{ request.GET.max_price }}">
                <input type="number" name="bedrooms" placeholder="Quartos mín." value="{{ request.GET.bedrooms }}">
                <button type="submit" class="search-btn">
                    <i class="fas fa-filter"></i> Filtrar
                </button>
            </form>
        </div>
        
        <!-- Resultados -->
        {% if properties %}
            <div class="properties-grid">
                {% for property in properties %}
                    <div class="property-card">
                        <a href="{% url 'property_detail' property.id %}">
                            {% if property.image %}
                                <img src="{{ property.image.url }}" alt="{{ property.title }}" class="property-image">
                            {% else %}
                                <img src="https://i.pinimg.com/originals/7e/e2/56/7ee2569fb6fe306ecaad1d18c78ea362.jpg" alt="{{ property.title }}" class="property-image">
                            {% endif %}
                            <div class="property-info">
                                <div class="property-price">{{ property.get_price_display }}</div>
                                <div class="property-title">{{ property.title }}</div>
                                <div class="property-address">
                                    <i class="fas fa-map-marker-alt"></i>
                                    {{ property.address }}, {{ property.city }}, {{ property.state }}
                                </div>
                                <div class="property-details">
                                    <span><i class="fas fa-bed"></i> {{ property.bedrooms }} quarto{{ property.bedrooms|pluralize }}</span>
                                    <span><i class="fas fa-bath"></i> {{ property.bathrooms }} banheiro{{ property.bathrooms|pluralize }}</span>
                                    <span><i class="fas fa-ruler-combined"></i> {{ property.area }} m²</span>
                                    {% if property.parking_spaces > 0 %}
                                        <span><i class="fas fa-car"></i> {{ property.parking_spaces }} vaga{{ property.parking_spaces|pluralize }}</span>
                                    {% endif %}
                                </div>
                            </div>
                        </a>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <div class="no-results">
                <i class="fas fa-search"></i>
                <p>Nenhuma propriedade encontrada com os filtros aplicados.</p>
                <p>Tente ajustar os filtros para ver mais resultados.</p>
            </div>
        {% endif %}
    </div>
</section>
{% endblock %}
